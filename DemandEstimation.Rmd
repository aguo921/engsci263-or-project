---
title: "Demand Estimates"
output: html_notebook
---

```{r}
Demand = read_csv("FoodstuffsDemands.csv",show_col_types=FALSE)
head(Demand)
```

```{r}
Demand %>% 
  pivot_longer(-c(Supermarket), names_to="Date", values_to="Demand") %>%
  mutate(Date = ymd(Date)) %>%
  mutate(Weekday = wday(Date, label=TRUE)) %>%
  subset(Weekday != 'Sun') %>% 
  mutate(DayType = ifelse(Weekday == 'Sat', 'Saturday', 'Weekday')) %>%
  group_by(DayType, Supermarket) %>%
  summarise(AverageDemand=ceiling(mean(Demand))) %>% 
  pivot_wider(names_from=DayType, values_from=AverageDemand) %>% 
  write.csv("DemandEstimates.csv", row.names=FALSE)
```